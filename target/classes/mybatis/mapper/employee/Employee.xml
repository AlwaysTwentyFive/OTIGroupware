<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.oti.groupware.employee.dao.EmployeeDAO">

    <select id="getPhoneNumber" resultType="string">
		select emp_phone_number
		from employees
	</select>
	
	<select id="getMailId" resultType="string">
		select emp_mail
		from employees
	</select>
	
	<select id="getEmpId" parameterType="map" resultType="string">
		select emp_id
		from employees
		where emp_id like #{completeId}
	</select>
	
	<select id="getLeaveReserve" parameterType="int" resultType="int">
		select pos_lev_cnt
		from positions
		where pos_id = #{posId}
	</select>
	
    <insert id="insertEmployee" parameterType="employee"  useGeneratedKeys="true" keyProperty="empId" keyColumn="emp_id">
        INSERT INTO employees (
            emp_id, pos_id, dep_id, emp_mail, emp_name, emp_password,
            emp_extension_number, emp_phone_number, emp_leave_reserve,
            emp_substitue_reserve, emp_login_failures_cnt, emp_file_data,
            emp_file_type,emp_file_name, emp_enabled
        ) VALUES (
            #{empId}, #{posId}, #{depId}, #{empMail}, #{empName},
            #{empPassword}, #{empExtensionNumber}, #{empPhoneNumber},
            #{empLeaveReserve}, default,
            default, #{empFileData},
            #{empFileType}, #{empFileName}, default
        )
    </insert>

	<insert id="insertEmployeeDetail" parameterType="employeeDetail">
		insert into employees_detail(
			EMP_ID, EMP_DETAIL_GENDER, EMP_DETAIL_BIRTHDAY, EMP_DETAIL_WORKPLACE,
			EMP_DETAIL_MARRIED_YN, EMP_DETAIL_EMPLOYMENT_DATE, EMP_DETAIL_EDUCATION, 
			EMP_DETAIL_EMPLOYMENT_STATE,EMP_DETAIL_MILITARY_SERVICE_YN, 
			EMP_DETAIL_MAJOR
		) values (
			#{empId}, #{empDetailGender}, #{empDetailBirthday}, #{empDetailWorkplace},
			#{empDetailMarriedYN}, #{empDetailEmploymentDate}, #{empDetailEducation},
			default, #{empDetailMilitaryServiceYN}, #{empDetailMajor}
		)
	</insert>
	
	
</mapper>